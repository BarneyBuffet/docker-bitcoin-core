version: '3.9'

services:
  bitcoin_core:
    image: bitcoin_core:dev
    user: "10000:10001"
    volumes:
      - /tmp/bitcoin_core_test/tor:/tor
      - /tmp/bitcoin_core_test/bitcoin_core:/bitcoin
    restart: always
    ports:
      - "8332:8332"
      - "8333:8333"
      - "28332:28332"
    environment:
      CONFIG_OVERWRITE: "true"
      LOG_CONFIG: "true"
      ALERT_NOTIFY: "alert_notify_comand"
      ASSUME_VALID: "00"
      BLOCK_FILTER_INDEX: "false"
      BLOCK_NOTIFY: "block_notify_command"
      BLOCK_RECONSTRUCTION_EXTRA_TXN: "100"
      BLOCKS_DIR: "/bitcoin"
      BLOCKS_ONLY: "false"
      CONF: "bitcoin.conf"
      DAEMON: "true"
      # DATA_DIR = \ # This is set by the image above so lets not double up
      DB_CACHE: "450"
      DEBUG_LOG_FILE: "debug.log"
      INCLUDE_CONF: "alt_bitcoin.conf"
      LOAD_BLOCK: "block_file"
      MAX_MEMPOOL: "300"
      MAX_ORPHAN_TX: "100"
      MEMPOOL_EXPIRY: "336"
      PAR: "0"
      PERSIST_MEMPOOL: "true"
      PID: "bitcoin.pid"
      PRUNE: "false"
      REINDEX: "true"
      REINDEX_CHAINSTATE: "true"
      SETTINGS: "settings.json"
      STARTUP_NOTIFY: "startup_notify_command"
      SYS_PERMS: "true"
      TX_INDEX: "false"
      ADD_NODE: "node_1:8333, node_2:8333"
      ASMAP: "ip_asn.map"
      BAN_TIME: "86400"
      BIND: "127.0.0.1:8334=onion"
      CONNECT: "192.168.0.112,192.168.0.113"
      DISCOVER: "true"
      DNS: "true"
      DNS_SEED: "true"
      EXTERNAL_IP: "192.168.0.2"
      FORCE_DNS_SEED: "false"
      LISTEN: "true"
      LISTEN_ONION: "true"
      MAX_CONNECTIONS: "125"
      MAX_RECEIVE_BUFFER: "5000"
      MAX_SEND_BUFFER: "1000"
      MAX_TIME_ADJUSTMENT: "4200"
      MAX_UPLOAD_TARGET: "0"
      NETWORK_ACTIVE: "true"
      ONION: "127.0.0.1"
      ONLY_NET: "onion"
      PEER_BLOCK_FILTERS: "false"
      PEER_BLOOM_FILTERS: "false"
      PERMIT_BARE_MULTISIG: "true"
      PORT: "8333"
      PROXY: "127.0.0.1:9050"
      PROXY_RANDOMIZE: "true"
      SEED_NODE: "192.168.0.56,192.168.0.57,192.168.0.58"
      TIMEOUT: "5000"
      TOR_CONTROL: "127.0.0.1:9051"
      TOR_PASSWORD: "tor_password"
      UPNP: "false"
      WHITE_BIND: "allow@192.168.0.45,allow@192.168.0.45,allow@192.168.0.45"
      WHITE_LIST: "allow@192.168.0.45,allow@192.168.0.45,allow@192.168.0.45"
      DEBUG: "tor,rpc,reindex"
      DEBUG_EXCLUDE: "bench"
      HELP_DEBUG: "true"
      LOG_IPS: "false"
      LOG_THREAD_NAMES: "false"
      LOG_TIMESTAMPS: "true"
      PRINT_TO_CONSOLE: "true"
      SHRINK_DEBUG_FILE: "true"
      UA_COMMENT: "<cmt>"
      CHAIN: "main"
      SIGNET: "true"
      SIGNET_CHALLENGE: "false"
      SIGNET_SEED_NODE: "192.168.0.56:8333,192.168.0.57:8333,192.168.0.58:8333"
      TEST_NET: "true"
      BYTES_PER_SIGOP: "20"
      DATA_CARRIER: "true"
      DATA_CARRIER_SIZE: "83"
      MIN_RELAY_TX_FEE: "0.0001"
      WHITE_LIST_FORCE_RELAY: "true"
      WHITE_LIST_RELAY: "true"
      BLOCK_MAX_WEIGHT: "3996000"
      BLOCK_MIN_TX_FEE: "0.00001"
      REST: "false"
      RPC_ALLOW_IP: "127.0.0.1,192.168.0.3"
      RPC_BIND: "127.0.0.01:8332"
      RPC_COOKIE_FILE: "<loc>"
      RPC_PASSWORD: "password"
      RPC_PORT: "8332"
      RPC_SERIAL_VERSION: "true"
      RPC_THREADS: "4"
      RPC_USER: "user"
      RPC_WHITE_LIST: "rpc_1, rpc_2"
      RPC_WHITE_LIST_DEFAULT: "true"
      SERVER: "true"
      ZMQ_PUB_HASH_TX: "tcp://ip-1:28332,tcp://ip-2:28332,tcp://ip-3:28332"
      ZMQ_PUB_HASH_BLOCK: "tcp://ip-1:28332,tcp://ip-2:28332,tcp://ip-3:28332"
      ZMQ_PUB_RAW_BLOCK: "tcp://ip-1:28332,tcp://ip-2:28332,tcp://ip-3:28332"
      ZMQ_PUB_RAW_TX: "ipc://bitcoin/zmq.socket"
      ZMQ_PUB_SEQUENCE: "1000"